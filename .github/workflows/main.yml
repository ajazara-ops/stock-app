name: Daily Stock Scanner

# ì–¸ì œ ì‹¤í–‰í• ì§€ ì„¤ì • (UTC ê¸°ì¤€)
on:
  schedule:
    # 1. í•œêµ­ ì‹œê°„ ì˜¤ì „ 8ì‹œ (ë¯¸êµ­ ì¥ ë§ˆê° í›„) -> UTC 23:00 (ì „ë‚ )
    - cron: '0 23 * * *'
    # 2. í•œêµ­ ì‹œê°„ ì˜¤í›„ 4ì‹œ (í•œêµ­ ì¥ ë§ˆê° í›„) -> UTC 07:00
    - cron: '0 7 * * *'
  # ìˆ˜ë™ìœ¼ë¡œ ë²„íŠ¼ ëˆŒëŸ¬ì„œ ì‹¤í–‰ ê°€ëŠ¥í•˜ê²Œ í•¨
  workflow_dispatch:

permissions:
  contents: write

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    - name: ì €ì¥ì†Œ ì½”ë“œ ê°€ì ¸ì˜¤ê¸° (Checkout)
      uses: actions/checkout@v3

    - name: íŒŒì´ì¬ ì„¤ì • (Set up Python)
      uses: actions/setup-python@v4
      with:
        python-version: '3.9'

    - name: ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜ (Install dependencies)
      run: |
        python -m pip install --upgrade pip
        pip install yfinance pandas requests lxml

    - name: ì£¼ì‹ ë¶„ì„ê¸° ì‹¤í–‰ (Run Scanner)
      run: |
        python daily_stock_scanner.py

    - name: ê²°ê³¼ íŒŒì¼ ì €ì¥ (Commit & Push)
      run: |
        git config --global user.name 'GitHub Actions Bot'
        git config --global user.email 'actions@github.com'
        git add todays_recommendation.json history/ history_index.json
        git commit -m "ğŸ“ˆ Daily Stock Data Updated $(date)" || echo "ë³€ê²½ ì‚¬í•­ ì—†ìŒ"
        git push
